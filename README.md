# HyoDo (å­é“) â€” AFO Kingdom's Guardian

> **Automated Code Quality for AI-Assisted Development**
> 
> *"Where Eastern Philosophy Meets Modern Software Engineering"*

<p align="center">
  <img src="https://img.shields.io/badge/Version-3.1.0-success" alt="Version">
  <img src="https://img.shields.io/badge/Python-3.10+-blue?logo=python" alt="Python">
  <img.shields.io/badge/Trinity_Score-94.16-brightgreen" alt="Trinity Score">
  <img src="https://img.shields.io/badge/License-MIT-yellow" alt="License">
  <img src="https://img.shields.io/badge/Security-Patched-success" alt="Security">
</p>

<p align="center">
  <a href="./i18n/ko/README.md">í•œêµ­ì–´</a> â€¢
  <a href="./i18n/zh/README.md">ä¸­æ–‡</a> â€¢
  <a href="./i18n/ja/README.md">æ—¥æœ¬èª</a>
</p>

---

## ğŸ¯ Executive Summary

HyoDo is the **entry point** to the AFO Kingdom ecosystemâ€”a philosophy-driven AI development framework that evaluates code through the lens of ancient wisdom. Built as a Claude Code extension, HyoDo brings the power of the **Trinity Score** to every developer's fingertips.

Unlike traditional linters that only check syntax, HyoDo evaluates your code against five philosophical pillars, ensuring not just working code, but **wise code**.

### Key Metrics
- **Cost Reduction**: 50-70% savings on AI API costs
- **Quality Gate**: 4-stage automated validation
- **Philosophy Engine**: 44 principles from 2,000 years of wisdom
- **Security**: Zero critical vulnerabilities (continuously patched)

---

## ğŸ›ï¸ The Five Pillars (çœå–„ç¾å­æ°¸)

Every decision in HyoDo is governed by the **Trinity Score**â€”a weighted evaluation system derived from Confucian and strategic philosophy:

| Pillar | Hanja | Weight | Focus | Question |
|:------:|:-----:|:------:|:------|:---------|
| **Truth** | çœ | 35% | Technical accuracy, type safety, evidence-based decisions | *"Will this work in 3 years?"* |
| **Goodness** | å–„ | 35% | Security, stability, risk assessment, ethics | *"What's the worst case?"* |
| **Beauty** | ç¾ | 20% | Code clarity, documentation, UX, cognitive load | *"Can humans understand this?"* |
| **Serenity** | å­ | 8% | Developer experience, frictionless workflows | *"Is this effortless?"* |
| **Eternity** | æ°¸ | 2% | Long-term maintainability, knowledge preservation | *"Will this survive us?"* |

### Trinity Score Formula
```
Score = 0.35Ã—çœ + 0.35Ã—å–„ + 0.20Ã—ç¾ + 0.08Ã—å­ + 0.02Ã—æ°¸
```

### Decision Matrix

| Trinity Score | Risk Score | Action | Description |
|:-------------:|:----------:|:-------|:------------|
| â‰¥ 90 | â‰¤ 10 | **AUTO_RUN** | Proceed automaticallyâ€”code meets royal standards |
| 70-89 | â‰¤ 10 | **ASK_COMMANDER** | Request approvalâ€”review recommended |
| < 70 | any | **BLOCK** | Changes requiredâ€”fixes mandatory |

---

## âš”ï¸ The Three Strategists (3ì±…ì‚¬)

HyoDo implements parallel strategist analysis through the **Chancellor Orchestrator**, inspired by King Sejong's court:

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   ğŸ‘‘ Chancellor (ìŠ¹ìƒ)      â”‚
                    â”‚   Decision Orchestrator     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                       â”‚                       â”‚
           â–¼                       â–¼                       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ çœ Jang     â”‚        â”‚ å–„ Yi       â”‚        â”‚ ç¾ Shin     â”‚
    â”‚ Yeong-sil   â”‚        â”‚ Sun-sin     â”‚        â”‚ Saimdang    â”‚
    â”‚ âš”ï¸ Spear    â”‚        â”‚ ğŸ›¡ï¸ Shield   â”‚        â”‚ ğŸŒ‰ Bridge   â”‚
    â”‚ (35%)       â”‚        â”‚ (35%)       â”‚        â”‚ (20%)       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| Strategist | Symbol | Persona | Role | Internal Engine |
|:-----------|:------:|:--------|:-----|:----------------|
| **Jang Yeong-sil** | âš”ï¸ | Jeong Yak-yong | Architecture, technical strategy | qwen2.5-coder |
| **Yi Sun-sin** | ğŸ›¡ï¸ | Ryu Seong-ryong | Security, risk assessment, ethics | deepseek-r1 |
| **Shin Saimdang** | ğŸŒ‰ | Heo Jun | UX, documentation, clarity | qwen3-vl |

Each strategist operates in parallel, providing independent analysis that is synthesized into the final Trinity Score.

---

## ğŸ—ï¸ Architecture

### The 11 Organs (åä¸€è‡Ÿå…­è…‘)

HyoDo connects to the AFO Kingdom's distributed organ system:

| Organ | Hanja | Service | Port | Role |
|:------|:-----:|:--------|:----:|:-----|
| Heart | å¿ƒ | Redis | 6379 | Session, cache, pub/sub |
| Liver | è‚ | PostgreSQL | 15432 | Persistent data storage |
| Brain | è…¦ | Soul Engine | 8010 | Main FastAPI API |
| Tongue | èˆŒ | Ollama | 11434 | Local LLM (Qwen3-VL + Gemma) |
| Lungs | è‚º | LanceDB | â€” | Vector embeddings |
| Eyes | çœ¼ | Dashboard | 3000 | Next.js 16 monitoring UI |
| Kidney | è… | MCP | â€” | External tool connections |

### Core Components

```
HyoDo/
â”œâ”€â”€ commands/          # 19 Claude Code slash commands
â”‚   â”œâ”€â”€ /start         # Welcome guide
â”‚   â”œâ”€â”€ /check         # 4-Gate CI validation
â”‚   â”œâ”€â”€ /score         # Trinity Score calculation
â”‚   â”œâ”€â”€ /safe          # Security scan (Yi Sun-sin)
â”‚   â”œâ”€â”€ /trinity       # Full pillar audit
â”‚   â””â”€â”€ /cost          # AI cost estimation
â”œâ”€â”€ skills/            # 4 skill categories
â”‚   â”œâ”€â”€ trinity-score-calculator/
â”‚   â”œâ”€â”€ strategy-engine/
â”‚   â”œâ”€â”€ philosophy-guide/
â”‚   â””â”€â”€ kingdom-navigator/
â”œâ”€â”€ agents/            # 3 Strategist configurations
â””â”€â”€ afo_core/          # Backend API (FastAPI)
```

---

## ğŸ“œ Philosophy in Code: The Royal Library

HyoDo encodes **44 principles** from classical texts into software engineering practices:

### I. The Art of War (ì†ìë³‘ë²•) â€” 13 Principles
> **Truth (çœ) 70% / Serenity (å­) 30%**

1. **Know Thyself (ì§€í”¼ì§€ê¸°)**: Query Context7/database before any actionâ€”hallucination prevention
2. **Win Without Fighting (ìƒë³‘ë²Œëª¨)**: Import existing libraries over writing new code
3. **DRY_RUN First (ë³‘ìê¶¤ë„ì•¼)**: Show simulation results before dangerous operations
4. **Speed is Value (ë³‘ê·€ì‹ ì†)**: Async/Celery for slow operations
5. **Five Factors (ë„ì²œì§€ì¥ë²•)**: Align goals, environment, resources, leadership, method
6. **Regular & Irregular (ì •ë³‘)**: Standard patterns first, then customization
7. **Profiling (í—ˆì‹¤)**: Find bottlenecks through measurement
8. **Exception Handling (êµ¬ë³€)**: Graceful degradation paths
9. **Observability (ìš©ê°„)**: Logs and monitoring as intelligence
10. **Destructive Actions (í™”ê³µ)**: Confirm dangerous operations with gates
11. **Ship Fast (ì¡¸ì†)**: MVP over perfect delay
12. **True Automation (ë¶€ì „ì´êµ´)**: Zero user friction
13. **Infrastructure != Code (ë„êµ¬ì™€ ëŒ€ìƒì˜ ë¶„ë¦¬)**: Docker status doesn't affect quality scores

### II. Romance of Three Kingdoms (ì‚¼êµ­ì§€) â€” 15 Principles
> **Eternity (æ°¸) 60% / Goodness (å–„) 40%**

14. **Loose Coupling (ë„ì›ê²°ì˜)**: Modules united by shared goals, not tight binding
15. **Three Retries (ì‚¼ê³ ì´ˆë ¤)**: `Retry(max=3, backoff=exponential)` for external APIs
16. **Graceful Degradation (ê³µì„±ê³„)**: Fallback UI even when broken
17. **Borrow Arrows (ì´ˆì„ ì°¨ì „)**: Leverage open source effectively
18. **Chain Strategy (ì—°í™˜ê³„)**: Microservices linked into powerful pipelines
19. **Beauty Trap (ë¯¸ì¸ê³„)**: Complex logic behind beautiful UI
20. **Iterate (ì¹ ì¢…ì¹ ê¸ˆ)**: Write â†’ Critique â†’ Refine loop
21. **Doubt the Instrument (ì¸¡ì • ë„êµ¬ì˜ ì˜ì‹¬)**: Verify measurement code before blaming services
22. **Environment Contracts (í™˜ê²½ë³€ìˆ˜ì˜ ê³„ì•½)**: Defensive parsing of HOST variables
23. **Optional Means N/A**: Exclude optional services from scoring (not zero)
24. **Timing (ë™ë‚¨í’)**: Scheduler utilization

*[See full 44 principles in AFO_ROYAL_LIBRARY.md]*

---

## ğŸš€ Quick Start

### Prerequisites
- Python 3.10+
- Claude Code CLI
- Git

### Installation

```bash
# Interactive installation (recommended)
curl -sSL https://raw.githubusercontent.com/lofibrainwav/HyoDo/main/install_interactive.sh | bash

# Or manual installation
git clone https://github.com/lofibrainwav/HyoDo.git ~/.hyodo
cd ~/.hyodo && ./install.sh
```

### Configuration

```bash
# Copy environment template
cp .env.minimal .env

# Edit with your API keys
nano .env
```

### Basic Usage

In Claude Code, use these commands:

```bash
/start              # Welcome guide and help
/check              # Run 4-Gate CI quality check
/score              # Calculate Trinity Score
/safe               # Security and risk scan
/trinity "analyze"  # Full pillar audit
/cost "feature"     # Estimate AI cost
```

---

## ğŸ›¡ï¸ Security: Zero Tolerance Policy

### Current Status: âœ… All Critical Vulnerabilities Patched

| CVE | Package | Severity | Status |
|:----|:--------|:---------|:-------|
| CVE-2026-25528 | langsmith | Medium | âœ… Patched (0.6.3) |
| CVE-2026-24688 | pypdf | Medium | âœ… Patched (6.6.2) |
| CVE-2026-24486 | python-multipart | High | âœ… Patched (0.0.22) |
| CVE-2026-0994 | protobuf | High | âœ… Patched (5.29.6) |
| CVE-2026-21441 | urllib3 | High | âœ… Patched (2.6.3) |

### Security Scanning

```bash
# Run security audit
pip-audit --desc --format=table

# Check for new vulnerabilities
safety check
```

### Security Principles

1. **Never commit secrets**: Pre-commit hooks automatically detect API keys
2. **PII Redaction**: All logs mask sensitive information
3. **Sandboxed Execution**: MCP tools run in isolated environments
4. **Dependency Pinning**: All packages pinned with SHA256 hashes

See [SECURITY_PATCHES.md](SECURITY_PATCHES.md) for detailed vulnerability history.

---

## ğŸ§ª Quality Gates: 4-Gate CI Protocol

Every change runs through the CI Lock Protocol:

```bash
make check    # Run all 4 gates
```

| Gate | Pillar | Tool | Purpose |
|:-----|:------:|:-----|:--------|
| **Gate 1** | çœ | Pyright | Type checking, regression detection |
| **Gate 2** | ç¾ | Ruff | Linting, formatting (line-length: 100) |
| **Gate 3** | å–„ | pytest | Unit tests (316+ tests) |
| **Gate 4** | æ°¸ | SBOM | Security seal, dependency audit |

### Test Markers

```bash
pytest -m smoke         # Quick smoke tests
pytest -m integration   # Integration tests
pytest -m slow          # Pre-deployment tests
pytest --cov=hyodo      # Coverage report
```

---

## ğŸ“Š Evolution Timeline

| Phase | Date | Milestone |
|:------|:-----|:----------|
| **Genesis** | Dec 2024 | Visual Creator awakening |
| **Awakening** | Dec 2025 | Trinity Philosophy installed (v1.0) |
| **Harmony** | Dec 2025 | 11 Organs + Dashboard + CPA (v2.0) |
| **Expansion** | Dec 2025 | Self-expanding mode activated (v2.5) |
| **Metacognition** | Feb 2026 | Phase 106: "Doubt the Instrument" (v3.0) |
| **Royal Library** | Feb 2026 | Phase 111: 44 Principles codified (v3.1) |

*[See full evolution in AFO_EVOLUTION_LOG.md]*

---

## ğŸŒ AFO Kingdom Ecosystem

HyoDo is the **beginner's entry point** to the larger AFO Kingdom:

| Component | Description | Tech Stack |
|:----------|:------------|:-----------|
| **HyoDo** | CLI plugin for Claude Code | Python, Typer |
| **afo-core** | Backend API, Chancellor Graph | FastAPI, LangGraph |
| **dashboard** | Real-time monitoring UI | Next.js 16, React 19 |
| **trinity-os** | Philosophy engine, RAG | LanceDB, Ollama |

---

## ğŸ¤ Contributing

### Quality Requirements

1. **All changes must pass 4-Gate CI**
2. **Trinity Score â‰¥ 70 required** for merge
3. **Evidence required**: Cite file paths, test outputs, or existing patterns
4. **No drive-by refactoring**: Keep diffs minimal

### Commit Convention

```
<type>(<scope>): <subject>

<body>

- Trinity Score: <score>
- Risk Score: <risk>
- 4-Gate CI: <status>
```

Types: `feat`, `fix`, `docs`, `style`, `refactor`, `test`, `chore`, `security`

### Decision Labels

- ğŸŸ¢ **AUTO_RUN**: Trinity â‰¥ 90, Risk â‰¤ 10
- ğŸŸ¡ **ASK_COMMANDER**: Trinity 70-89
- ğŸ”´ **BLOCK**: Trinity < 70

See [CONTRIBUTING.md](CONTRIBUTING.md) for full guidelines.

---

## ğŸ“š Documentation

| Document | Purpose |
|:---------|:--------|
| [QUICK_START_SIMPLE.md](QUICK_START_SIMPLE.md) | 3-minute quickstart guide |
| [QUICK_START.md](QUICK_START.md) | Detailed setup instructions |
| [AGENTS.md](AGENTS.md) | AI agent governance rules |
| [SECURITY_PATCHES.md](SECURITY_PATCHES.md) | Vulnerability tracking |
| [CHANGELOG.md](CHANGELOG.md) | Version history |
| [PHILOSOPHY.md](PHILOSOPHY.md) | Five Pillars deep dive |

---

## ğŸ“„ License

MIT License â€” See [LICENSE](LICENSE)

---

<p align="center">
  <em>"One Truth, One System, One Kingdom"</em><br>
  <strong>í•˜ë‚˜ì˜ ì§„ë¦¬, í•˜ë‚˜ì˜ ì‹œìŠ¤í…œ, í•˜ë‚˜ì˜ ì™•êµ­</strong><br><br>
  <em>Built with the Spirit of King Sejong</em><br>
  <strong>ì„¸ì¢…ëŒ€ì™•ì˜ ì •ì‹ ìœ¼ë¡œ</strong>
</p>
